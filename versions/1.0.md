# SalahAPI Specification

#### Version 1.0

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC 2119](http://www.ietf.org/rfc/rfc2119.txt).

## Table of Contents

- [1. Introduction](#1-introduction)
- [2. Revision History](#2-revision-history)
- [3. Specification](#3-specification)
  - [3.1. SalahAPI JSON Document Structure](#31-salahapi-json-document-structure)
  - [3.2. SalahAPI CSV Data Structure](#32-salahapi-csv-data-structure)
- [4. Data Structures](#4-data-structures)
  - [Info Object](#info-object)
  - [Location Object](#location-object)
  - [CalculationMethod Object](#calculationmethod-object)
  - [Daily Prayer Times Object](#daily-prayer-times-object)
  - [CSV URL Parameters Object](#csv-url-parameters-object)

## 1. Introduction

SalahAPI is a specification for defining Islamic prayer times data in a structured format. It provides a standard way to represent prayer times, calculation methods, and location information, enabling interoperability between different systems and applications.

## 2. Revision History

| Version | Date       | Description                          |
|---------|------------|--------------------------------------|
| 1.0     | 2025-12-15 | Initial release of SalahAPI Specification |

## 3. Specification

### 3.1. SalahAPI JSON Document Structure

The SalahAPI document is a JSON object that contains the following fields:
- **salahapi** `string` - The version of the SalahAPI Specification being used
- **info** `Info Object` - Metadata about the prayer times data
- **location** `Location Object` - Geographic coordinates and timezone information (optional when using CSV data)
- **calculationMethod** `CalculationMethod Object` - Parameters used for prayer time calculations (optional when using CSV data)
- **dailyPrayerTimes** `DailyPrayerTimes Object` - Contains the reference to the CSV prayer times data (optional when using dynamic calculation methods)
- **csvUrlParameters** `CsvUrlParameters Object` - Optional URL parameters that can be passed to the CSV endpoint

Example document with CSV prayer times data:

```json
{
  "salahapi": "1.0.0",
  "info": {
    "title": "New York Islamic Center Prayer Times",
    "description": "Prayer times for New York City using ISNA calculation method",
    "version": "1.0.0",
    "contact": {
      "name": "Support",
      "email": "support@example.com"
    }
  },
  "dailyPrayerTimes": {
    "csvUrl": "https://example.com/prayer_times",
    "csvUrlParameters": {
      "fromDate": {
        "in": "query",
        "type": "fromDate",
        "format": "YYYY-MM-DD"
      },
      "toDate": {
        "in": "query",
        "type": "toDate",
        "format": "YYYY-MM-DD"
      },
      "longitude": {
        "in": "query",
        "value": -74.0060
      }
    },
    "dateFormat": "YYYY-MM-DD",
    "timeFormat": "HH:mm:ss"
  }
}
```

Example document with calculation metadata:

```json
{
  "salahapi": "1.0.0",
  "info": {
    "title": "New York Islamic Center Prayer Times",
    "description": "Prayer times for New York City using ISNA calculation method",
    "version": "1.0.0",
    "contact": {
      "name": "Support",
      "email": "support@example.com"
    }
  },
  "location": {
    "latitude": 40.7128,
    "longitude": -74.0060,
    "timezone": "America/New_York",
    "city": "New York",
    "country": "United States",
    "dateFormat": "YYYY-MM-DD",
    "timeFormat": "HH:mm:ss"
  },
  "calculationMethod": {
    "name": "ISNA",
    "fajrAngle": 15,
    "ishaAngle": 15,
    "asrCalculationMethod": "Standard",
    "highLatitudeAdjustment": "MiddleOfTheNight",
    "iqamaCalculationRules": {
      "changeOn": "friday",
      "fajr": {
        "change": "daily",
        "roundMinutes": "15",
        "earliest": "04:00",
        "latest": "06:45",
        "beforeEndMinutes": "30"
      },
      "dhuhr": {
        "static": "12:30"
      },
      "dhuhrDST": {
        "static": "13:30"
      },
      "asr": {
        "change": "weekly",
        "roundMinutes": "15",
        "afterAthanMinutes": "15"
      },
      "asrDST": {
        "static": "16:30",
      },
      "maghrib": {
        "change": "daily",
        "roundMinutes": "1",
        "afterAthanMinutes": "10"
      },
      "isha": {
        "change": "weekly",
        "roundMinutes": "1",
        "afterAthanMinutes": "10",
        "latest": "23:45"
      }
    },
    "jumuahRules": [
      {
        "name": "Jumuah 1",
        "time": {
          "static": "12:00"
        },
        "timeDST": {
          "static": "13:00"
        },
        "location": {
          "name": "New York Islamic Center",
          "address": "123 Main St, New York, NY 10001"
        }
      },
      {
        "name": "Jumuah 2",
        "time": {
          "static": "none"
        },
        "timeDST": {
          "static": "14:00"
        },
        "location": {
          "name": "New York Islamic Center",
          "address": "123 Main St, New York, NY 10001"
        }
      },
      {
        "name": "Youth Jumuah",
        "time": {
          "static": "none"
        },
        "timeDST": {
          "change": "weekly",
          "roundMinutes": "30",
          "beforeEndMinutes": "60"
        },
        "location": {
          "name": "New York Islamic Center",
          "address": "123 Main St, New York, NY 10001"
        }
      }
    ]
  }
}
```

Example document with calculation metadata and CSV data used to overwrite calculations for specific dates:

```json
{
  "salahapi": "1.0",
  "info": {
    "title": "New York Islamic Center Prayer Times",
    "description": "Prayer times for New York City using ISNA calculation method",
    "version": "1.0.0",
    "contact": {
      "name": "Support",
      "email": "support@example.com"
    }
  },
  "location": {
    "latitude": 40.7128,
    "longitude": -74.0060,
    "timezone": "America/New_York",
    "city": "New York",
    "country": "United States",
    "dateFormat": "YYYY-MM-DD",
    "timeFormat": "HH:mm:ss"
  },
  "calculationMethod": {
    "name": "ISNA",
    "fajrAngle": 15,
    "ishaAngle": 15,
    "asrCalculationMethod": "Standard",
    "highLatitudeAdjustment": "MiddleOfTheNight"
  },
  "dailyPrayerTimes": {
    "csvUrl": "https://example.com/prayer_times.csv",
    "dateFormat": "YYYY-MM-DD",
    "timeFormat": "HH:mm:ss"
  }
}
```

### 3.2. SalahAPI CSV Data Structure

The SalahAPI CSV data contains daily prayer times data in a structured format. The first row contains the headers, and subsequent rows contain the prayer times for each date.

The CSV data should have the following columns:
 - **day** - Date in the format specified by "dateFormat" field (e.g., "YYYY-MM-DD")
 - **fajr_athan** - Time of Fajr Athan
 - **fajr_iqama** - Time of Fajr Iqama
 - **sunrise** - Time of Sunrise
 - **dhuhr_athan** - Time of Dhuhr Athan
 - **dhuhr_iqama** - Time of Dhuhr Iqama
 - **asr_athan** - Time of Asr Athan
 - **asr_iqama** - Time of Asr Iqama
 - **maghrib_athan** - Time of Maghrib Athan
 - **maghrib_iqama** - Time of Maghrib Iqama
 - **isha_athan** - Time of Isha Athan
 - **isha_iqama** - Time of Isha Iqama

All times should be in the format specified by "timeFormat" field (e.g., "HH:mm:ss" for 24-hour format or "hh:mm A" for 12-hour format).

## 4. Data Structures

- **salahapi**: `string` - The version of the SalahAPI Specification being used (e.g., "1.0")

### Info Object

Provides metadata about the prayer times data.

**Fields:**

- **title** `string` - The title of the organization or service providing the prayer times
- **description** `string` - A description of the organization or service
- **version** `string` - The version of the prayer times data document
- **contact** `Contact Object` - Contact information for the service maintainer

### Location Object

Defines the geographic location for which prayer times are calculated.

**Fields:**

- **latitude** `number` **REQUIRED** - Decimal degrees (-90 to 90)
- **longitude** `number` **REQUIRED** - Decimal degrees (-180 to 180)
- **timezone** `string` **REQUIRED** - IANA timezone identifier (e.g., "America/New_York")
- **city** `string` - City name
- **country** `string` - Country name
- **dateFormat** `string` **REQUIRED** - Date format used in the document (e.g., "YYYY-MM-DD" for ISO 8601 or "DD/MM/YYYY" for common formats)
- **timeFormat** `string` **REQUIRED** - Time format used in the document (e.g., "HH:mm" for 24-hour format or "hh:mm A" for 12-hour format)

### CalculationMethod Object

Defines the parameters used for calculating prayer times.

**Fields:**

- **name** `calculationEnum` **REQUIRED** - one of the calculationEnum values
- **fajrAngle** `number` - Angle of sun below horizon for Fajr (degrees) when overriding the default calculation method
- **ishaAngle** `number` - Angle of sun below horizon for Isha (degrees) when overriding the default calculation method
- **asrCalculationMethod** `string` - Method for calculating Asr
- **highLatitudeAdjustment** `string` - Adjustment method for high latitude locations
- **iqamaCalculationRules** `IqamaCalculationRules Object` - Rules for calculating Iqama times
- **jumuahRules** `array of JumuahRule Object` - Array of Jumuah (Friday prayer) rules

**Enums:**

- **calculationEnum** - Enum representing the calculation method used for prayer times. The following values are defined:

| Name | Description | Fajr Angle | Isha Angle |
|------------------|-------------|------------|------------|
| isna             | Islamic Society of North America | 15° | 15° |
| mwl              | Muslim World League | 18° | 17° |
| egypt            | Egyptian General Authority of Survey | 19.5° | 17.5° |
| makkah           | Umm al-Qura University, Makkah | 18.5° | 90 min after Maghrib |
| karachi          | University of Islamic Sciences, Karachi | 18° | 18° |
| tehran           | Iranian calculation method | 17.7° | 14° |
| jafari           | Shia Jafari calculation method | 16° | 14° |
| dubai            | Dubai, UAE | 18.2° | 18.2° |
| kuwait           | Kuwait | 18° | 17.5° |
| qatar            | Qatar | 18° | 90 min after Maghrib |
| singapore        | Singapore | 20° | 18° |
| france           | Union des Organisations Islamiques de France (UOIF) | 12° | 12° |
| turkey           | Turkey's Diyanet İşleri Başkanlığı | 18° | 17° |
| russia           | Spiritual Administration of Muslims of Russia | 16° | 15° |
| other            | Custom calculation method defined by the user | User-defined | User-defined |

- **asrCalculationEnum** - Enum representing the method for calculating Asr prayer time. The following values are defined:

| Name     | Description |
|----------|-------------|
| standard | Standard Asr calculation (1:1 ratio) |
| hanafi   | Hanafi Asr calculation (2:1 ratio) |

- **highLatitudeAdjustmentEnum** - Enum representing the adjustment method for high latitude locations. The following values are defined:
| Name                | Description |
|---------------------|-------------|
| middleOfTheNight    | Use middle of the night for Fajr and Isha |
| oneSeventh          | Use one-seventh of the night for Fajr and Isha |
| twilightAngle       | Use twilight angle for Fajr and Isha |

### Iqama Calculation Rules Object

Defines the rules for calculating Iqama (congregation prayer start time) times.

**Fields:**

- **changeOn** `string` - Day of the week when Iqama times change (one of: "sunday", "monday", "tuesday", "wednesday", "thursday", "friday", "saturday")
- **fajr** `PrayerCalculationRule Object` - Calculation rule for Fajr Iqama
- **fajrDST** `PrayerCalculationRule Object` - DST override for Fajr Iqama
- **dhuhr** `PrayerCalculationRule Object` - Calculation rule for Dhuhr Iqama
- **dhuhrDST** `PrayerCalculationRule Object` - DST override for Dhuhr Iqama
- **asr** `PrayerCalculationRule Object` - Calculation rule for Asr Iqama
- **asrDST** `PrayerCalculationRule Object` - DST override for Asr Iqama
- **maghrib** `PrayerCalculationRule Object` - Calculation rule for Maghrib Iqama
- **maghribDST** `PrayerCalculationRule Object` - DST override for Maghrib Iqama
- **isha** `PrayerCalculationRule Object` - Calculation rule for Isha Iqama
- **ishaDST** `PrayerCalculationRule Object` - DST override for Isha Iqama

### Prayer Calculation Rule Object

Defines a single prayer time calculation rule.

**Fields:**

- **static** `string` - Static time value in 24-hour format (e.g., "12:30"). If specified, all other fields are ignored.
- **change** `string` - Frequency of change: "daily" or "weekly"
- **roundMinutes** `number` - Number of minutes to round to (e.g., 15 for quarter-hour rounding)
- **earliest** `string` - Earliest allowed time in 24-hour format (e.g., "04:00")
- **latest** `string` - Latest allowed time in 24-hour format (e.g., "23:45")
- **afterAthanMinutes** `number` - Delay in minutes after the Athan (call to prayer)
- **beforeEndMinutes** `number` - Minutes before the end of the prayer timeframe

### Jumuah Rule Object

Defines a single Jumuah (Friday prayer) rule.

**Fields:**

- **name** `string` - Name of the Jumuah prayer (e.g., "Jumuah 1", "Youth Jumuah")
- **time** `PrayerCalculationRule Object` - Calculation rule for Jumuah time
- **timeDST** `PrayerCalculationRule Object` - DST override for Jumuah time
- **location** `JumuahLocation Object` - Location information for the Jumuah prayer

### Jumuah Location Object

Defines the location for a Jumuah prayer.

**Fields:**

- **name** `string` - Name of the location (e.g., "Main Prayer Hall", "Community Center")
- **address** `string` - Physical address of the location
 
### Daily Prayer Times Object

Provides a reference to the static CSV data containing daily prayer times.

**Fields:**

- **csvUrl** `string` **REQUIRED** - URL to the endpoint containing prayer times in CSV format
- **dateFormat** `string` **REQUIRED** - Date format used in the CSV (e.g., "YYYY-MM-DD" for ISO 8601 or "DD/MM/YYYY" for common formats)
- **timeFormat** `string` **REQUIRED** - Time format used in the CSV (e.g., "HH:mm" for 24-hour format or "hh:mm A" for 12-hour format)

### CSV URL Parameters Object

Defines optional URL parameters that can be passed to the CSV endpoint.

**Fields:**

Each parameter can be either a static value or a date parameter:

- **Static value parameters** - Have a `value` field containing the value to pass
  - **in** `string` **REQUIRED** - Where the parameter should be sent ("query", "path", or "header")
  - **value** `string` or `number` **REQUIRED** - The static value to pass as a parameter
  
- **Date parameters** - Have a `type` and `format` field
  - **in** `string` **REQUIRED** - Where the parameter should be sent ("query", "path", or "header")
  - **type** `string` **REQUIRED** - Either "fromDate" or "toDate"
  - **format** `string` **REQUIRED** - Date format for the parameter (e.g., "YYYY-MM-DD")