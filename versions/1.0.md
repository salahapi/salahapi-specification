# SalahAPI Specification

#### Version 1.0

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC 2119](http://www.ietf.org/rfc/rfc2119.txt).

## Table of Contents

- [1. Introduction](#1-introduction)
- [2. Revision History](#2-revision-history)
- [3. Specification](#3-specification)
  - [3.1. SalahAPI JSON Document Structure](#31-salahapi-json-document-structure)
  - [3.2. SalahAPI CSV Data Structure](#32-salahapi-csv-data-structure)
- [4. Data Structures](#4-data-structures)
  - [Info Object](#info-object)
  - [Location Object](#location-object)
  - [CalculationMethod Object](#calculationmethod-object)
  - [Daily Prayer Times Object](#daily-prayer-times-object)
  - [CSV URL Parameters Object](#csv-url-parameters-object)

## 1. Introduction

This document specifies SalahAPI, a standard format for representing Islamic prayer times data in a structured manner. The specification defines a standardized representation for prayer times, calculation methods, and location information to enable interoperability between different systems and applications.

## 2. Revision History

| Version | Date       | Description                          |
|---------|------------|--------------------------------------|
| 1.0     | 2025-12-15 | Initial release of SalahAPI Specification |

## 3. Specification

### 3.1. SalahAPI JSON Document Structure

A SalahAPI document is represented as a JSON object. The document structure is defined as follows:

- **salahapi** `string` - **REQUIRED**. The version of the SalahAPI Specification that the document conforms to.
- **info** `Info Object` - **OPTIONAL**. Metadata describing the prayer times data.
- **location** `Location Object` - **OPTIONAL**. Geographic coordinates and timezone information. This field MAY be omitted when using CSV data.
- **calculationMethod** `CalculationMethod Object` - **OPTIONAL**. Parameters used for prayer time calculations. This field MAY be omitted when using CSV data.
- **dailyPrayerTimes** `DailyPrayerTimes Object` - **OPTIONAL**. Reference to the CSV prayer times data. This field MAY be omitted when using dynamic calculation methods.
- **csvUrlParameters** `CsvUrlParameters Object` - **OPTIONAL**. URL parameters that MAY be passed to the CSV endpoint.

Example document with CSV prayer times data:

```json
{
  "salahapi": "1.0.0",
  "info": {
    "title": "New York Islamic Center Prayer Times",
    "description": "Prayer times for New York City using ISNA calculation method",
    "version": "1.0.0",
    "contact": {
      "name": "Support",
      "email": "support@example.com"
    }
  },
  "dailyPrayerTimes": {
    "csvUrl": "https://example.com/prayer_times",
    "csvUrlParameters": {
      "fromDate": {
        "in": "query",
        "type": "fromDate",
        "format": "YYYY-MM-DD"
      },
      "toDate": {
        "in": "query",
        "type": "toDate",
        "format": "YYYY-MM-DD"
      },
      "longitude": {
        "in": "query",
        "value": -74.0060
      }
    },
    "dateFormat": "YYYY-MM-DD",
    "timeFormat": "HH:mm:ss"
  }
}
```

Example document with calculation metadata:

```json
{
  "salahapi": "1.0.0",
  "info": {
    "title": "New York Islamic Center Prayer Times",
    "description": "Prayer times for New York City using ISNA calculation method",
    "version": "1.0.0",
    "contact": {
      "name": "Support",
      "email": "support@example.com"
    }
  },
  "location": {
    "latitude": 40.7128,
    "longitude": -74.0060,
    "timezone": "America/New_York",
    "city": "New York",
    "country": "United States",
    "dateFormat": "YYYY-MM-DD",
    "timeFormat": "HH:mm:ss"
  },
  "calculationMethod": {
    "name": "ISNA",
    "fajrAngle": 15,
    "ishaAngle": 15,
    "asrCalculationMethod": "Standard",
    "highLatitudeAdjustment": "MiddleOfTheNight",
    "iqamaCalculationRules": {
      "changeOn": "friday",
      "fajr": {
        "change": "daily",
        "roundMinutes": "15",
        "earliest": "04:00",
        "latest": "06:45",
        "beforeEndMinutes": "30"
      },
      "dhuhr": {
        "static": "12:30"
      },
      "dhuhrDST": {
        "static": "13:30"
      },
      "asr": {
        "change": "weekly",
        "roundMinutes": "15",
        "afterAthanMinutes": "15"
      },
      "asrDST": {
        "static": "16:30",
      },
      "maghrib": {
        "change": "daily",
        "roundMinutes": "1",
        "afterAthanMinutes": "10"
      },
      "isha": {
        "change": "weekly",
        "roundMinutes": "1",
        "afterAthanMinutes": "10",
        "latest": "23:45"
      }
    },
    "jumuahRules": [
      {
        "name": "Jumuah 1",
        "time": {
          "static": "12:00"
        },
        "timeDST": {
          "static": "13:00"
        },
        "location": {
          "name": "New York Islamic Center",
          "address": "123 Main St, New York, NY 10001"
        }
      },
      {
        "name": "Jumuah 2",
        "time": {
          "static": "none"
        },
        "timeDST": {
          "static": "14:00"
        },
        "location": {
          "name": "New York Islamic Center",
          "address": "123 Main St, New York, NY 10001"
        }
      },
      {
        "name": "Youth Jumuah",
        "time": {
          "static": "none"
        },
        "timeDST": {
          "change": "weekly",
          "roundMinutes": "30",
          "beforeEndMinutes": "60"
        },
        "location": {
          "name": "New York Islamic Center",
          "address": "123 Main St, New York, NY 10001"
        }
      }
    ]
  }
}
```

Example document with calculation metadata and CSV data used to overwrite calculations for specific dates:

```json
{
  "salahapi": "1.0",
  "info": {
    "title": "New York Islamic Center Prayer Times",
    "description": "Prayer times for New York City using ISNA calculation method",
    "version": "1.0.0",
    "contact": {
      "name": "Support",
      "email": "support@example.com"
    }
  },
  "location": {
    "latitude": 40.7128,
    "longitude": -74.0060,
    "timezone": "America/New_York",
    "city": "New York",
    "country": "United States",
    "dateFormat": "YYYY-MM-DD",
    "timeFormat": "HH:mm:ss"
  },
  "calculationMethod": {
    "name": "ISNA",
    "fajrAngle": 15,
    "ishaAngle": 15,
    "asrCalculationMethod": "Standard",
    "highLatitudeAdjustment": "MiddleOfTheNight"
  },
  "dailyPrayerTimes": {
    "csvUrl": "https://example.com/prayer_times.csv",
    "dateFormat": "YYYY-MM-DD",
    "timeFormat": "HH:mm:ss"
  }
}
```

### 3.2. SalahAPI CSV Data Structure

SalahAPI CSV data represents daily prayer times in a structured tabular format. The first row SHALL contain column headers, and subsequent rows SHALL contain the prayer times for each date.

The CSV data SHALL include the following columns:
 - **day** - Date value in the format specified by the `dateFormat` field (e.g., "YYYY-MM-DD")
 - **fajr_athan** - Fajr Athan time
 - **fajr_iqama** - Fajr Iqama time
 - **sunrise** - Sunrise time
 - **dhuhr_athan** - Dhuhr Athan time
 - **dhuhr_iqama** - Dhuhr Iqama time
 - **asr_athan** - Asr Athan time
 - **asr_iqama** - Asr Iqama time
 - **maghrib_athan** - Maghrib Athan time
 - **maghrib_iqama** - Maghrib Iqama time
 - **isha_athan** - Isha Athan time
 - **isha_iqama** - Isha Iqama time

All time values SHALL be formatted according to the `timeFormat` field (e.g., "HH:mm:ss" for 24-hour format or "hh:mm A" for 12-hour format).

## 4. Data Structures

- **salahapi**: `string` - The version of the SalahAPI Specification being used (e.g., "1.0")

### Info Object

The Info Object provides metadata about the prayer times data.

**Fields:**

- **title** `string` - **OPTIONAL**. A human-readable title of the organization or service providing the prayer times.
- **description** `string` - **OPTIONAL**. A textual description of the organization or service.
- **version** `string` - **OPTIONAL**. The version identifier of the prayer times data document.
- **contact** `Contact Object` - **OPTIONAL**. Contact information for the service maintainer.

### Location Object

The Location Object specifies the geographic location for which prayer times are calculated.

**Fields:**

- **latitude** `number` - **REQUIRED**. Geographic latitude in decimal degrees. Valid range: -90 to 90.
- **longitude** `number` - **REQUIRED**. Geographic longitude in decimal degrees. Valid range: -180 to 180.
- **timezone** `string` - **REQUIRED**. IANA timezone identifier (e.g., "America/New_York").
- **city** `string` - **OPTIONAL**. The name of the city.
- **country** `string` - **OPTIONAL**. The name of the country.
- **dateFormat** `string` - **REQUIRED**. The date format pattern used throughout the document (e.g., "YYYY-MM-DD" for ISO 8601 or "DD/MM/YYYY" for alternative formats).
- **timeFormat** `string` - **REQUIRED**. The time format pattern used throughout the document (e.g., "HH:mm" for 24-hour format or "hh:mm A" for 12-hour format).

### CalculationMethod Object

The CalculationMethod Object specifies the parameters used for calculating prayer times.

**Fields:**

- **name** `calculationEnum` - **REQUIRED**. The calculation method identifier. Value MUST be one of the defined `calculationEnum` values.
- **fajrAngle** `number` - **OPTIONAL**. The angle of the sun below the horizon for Fajr calculation, in degrees. This field MAY be used to override the default calculation method.
- **ishaAngle** `number` - **OPTIONAL**. The angle of the sun below the horizon for Isha calculation, in degrees. This field MAY be used to override the default calculation method.
- **asrCalculationMethod** `string` - **OPTIONAL**. The method for calculating Asr prayer time. Value MUST be one of the defined `asrCalculationEnum` values.
- **highLatitudeAdjustment** `string` - **OPTIONAL**. The adjustment method for high latitude locations. Value MUST be one of the defined `highLatitudeAdjustmentEnum` values.
- **iqamaCalculationRules** `IqamaCalculationRules Object` - **OPTIONAL**. Rules for calculating Iqama times.
- **jumuahRules** `array of JumuahRule Object` - **OPTIONAL**. An array of Jumuah (Friday prayer) rules.

**Enumerations:**

- **calculationEnum** - Enumeration defining the calculation method used for prayer times. The following values are defined:

| Name | Description | Fajr Angle | Isha Angle |
|------------------|-------------|------------|------------|
| isna             | Islamic Society of North America | 15° | 15° |
| mwl              | Muslim World League | 18° | 17° |
| egypt            | Egyptian General Authority of Survey | 19.5° | 17.5° |
| makkah           | Umm al-Qura University, Makkah | 18.5° | 90 min after Maghrib |
| karachi          | University of Islamic Sciences, Karachi | 18° | 18° |
| tehran           | Iranian calculation method | 17.7° | 14° |
| jafari           | Shia Jafari calculation method | 16° | 14° |
| dubai            | Dubai, UAE | 18.2° | 18.2° |
| kuwait           | Kuwait | 18° | 17.5° |
| qatar            | Qatar | 18° | 90 min after Maghrib |
| singapore        | Singapore | 20° | 18° |
| france           | Union des Organisations Islamiques de France (UOIF) | 12° | 12° |
| turkey           | Turkey's Diyanet İşleri Başkanlığı | 18° | 17° |
| russia           | Spiritual Administration of Muslims of Russia | 16° | 15° |
| other            | Custom calculation method defined by the user | User-defined | User-defined |

- **asrCalculationEnum** - Enumeration defining the method for calculating Asr prayer time. The following values are defined:

| Name     | Description |
|----------|-------------|
| standard | Standard Asr calculation (1:1 ratio) |
| hanafi   | Hanafi Asr calculation (2:1 ratio) |

- **highLatitudeAdjustmentEnum** - Enumeration defining the adjustment method for high latitude locations. The following values are defined:

| Name                | Description |
|---------------------|-------------|
| middleOfTheNight    | Use middle of the night for Fajr and Isha |
| oneSeventh          | Use one-seventh of the night for Fajr and Isha |
| twilightAngle       | Use twilight angle for Fajr and Isha |

### Iqama Calculation Rules Object

The Iqama Calculation Rules Object specifies the rules for calculating Iqama (congregation prayer start time) times.

**Fields:**

- **changeOn** `string` - **OPTIONAL**. The day of the week when Iqama times change. Value MUST be one of: "sunday", "monday", "tuesday", "wednesday", "thursday", "friday", "saturday".
- **fajr** `PrayerCalculationRule Object` - **OPTIONAL**. Calculation rule for Fajr Iqama.
- **fajrDST** `PrayerCalculationRule Object` - **OPTIONAL**. Daylight Saving Time override for Fajr Iqama.
- **dhuhr** `PrayerCalculationRule Object` - **OPTIONAL**. Calculation rule for Dhuhr Iqama.
- **dhuhrDST** `PrayerCalculationRule Object` - **OPTIONAL**. Daylight Saving Time override for Dhuhr Iqama.
- **asr** `PrayerCalculationRule Object` - **OPTIONAL**. Calculation rule for Asr Iqama.
- **asrDST** `PrayerCalculationRule Object` - **OPTIONAL**. Daylight Saving Time override for Asr Iqama.
- **maghrib** `PrayerCalculationRule Object` - **OPTIONAL**. Calculation rule for Maghrib Iqama.
- **maghribDST** `PrayerCalculationRule Object` - **OPTIONAL**. Daylight Saving Time override for Maghrib Iqama.
- **isha** `PrayerCalculationRule Object` - **OPTIONAL**. Calculation rule for Isha Iqama.
- **ishaDST** `PrayerCalculationRule Object` - **OPTIONAL**. Daylight Saving Time override for Isha Iqama.

### Prayer Calculation Rule Object

The Prayer Calculation Rule Object specifies a single prayer time calculation rule.

**Fields:**

- **static** `string` - **OPTIONAL**. A static time value in 24-hour format (e.g., "12:30"). When this field is specified, all other fields SHALL be ignored.
- **change** `string` - **OPTIONAL**. The frequency of change. Value MUST be either "daily" or "weekly".
- **roundMinutes** `number` - **OPTIONAL**. The rounding interval in minutes (e.g., 15 for quarter-hour rounding).
- **earliest** `string` - **OPTIONAL**. The earliest allowed time in 24-hour format (e.g., "04:00").
- **latest** `string` - **OPTIONAL**. The latest allowed time in 24-hour format (e.g., "23:45").
- **afterAthanMinutes** `number` - **OPTIONAL**. The delay in minutes after the Athan (call to prayer).
- **beforeEndMinutes** `number` - **OPTIONAL**. The number of minutes before the end of the prayer timeframe.

### Jumuah Rule Object

The Jumuah Rule Object specifies a single Jumuah (Friday prayer) rule.

**Fields:**

- **name** `string` - **OPTIONAL**. The name of the Jumuah prayer (e.g., "Jumuah 1", "Youth Jumuah").
- **time** `PrayerCalculationRule Object` - **OPTIONAL**. Calculation rule for Jumuah time.
- **timeDST** `PrayerCalculationRule Object` - **OPTIONAL**. Daylight Saving Time override for Jumuah time.
- **location** `JumuahLocation Object` - **OPTIONAL**. Location information for the Jumuah prayer.

### Jumuah Location Object

The Jumuah Location Object specifies the location for a Jumuah prayer.

**Fields:**

- **name** `string` - **OPTIONAL**. The name of the location (e.g., "Main Prayer Hall", "Community Center").
- **address** `string` - **OPTIONAL**. The physical address of the location.
 
### Daily Prayer Times Object

The Daily Prayer Times Object provides a reference to the CSV data containing daily prayer times.

**Fields:**

- **csvUrl** `string` - **REQUIRED**. The URL of the endpoint that serves prayer times in CSV format.
- **dateFormat** `string` - **REQUIRED**. The date format pattern used in the CSV (e.g., "YYYY-MM-DD" for ISO 8601 or "DD/MM/YYYY" for alternative formats).
- **timeFormat** `string` - **REQUIRED**. The time format pattern used in the CSV (e.g., "HH:mm" for 24-hour format or "hh:mm A" for 12-hour format).

### CSV URL Parameters Object

The CSV URL Parameters Object specifies optional URL parameters that MAY be passed to the CSV endpoint.

**Fields:**

Each parameter SHALL be either a static value parameter or a date parameter:

- **Static value parameters** - Parameters with a `value` field:
  - **in** `string` - **REQUIRED**. The location where the parameter SHALL be sent. Value MUST be one of: "query", "path", or "header".
  - **value** `string` or `number` - **REQUIRED**. The static value to be passed as the parameter.
  
- **Date parameters** - Parameters with `type` and `format` fields:
  - **in** `string` - **REQUIRED**. The location where the parameter SHALL be sent. Value MUST be one of: "query", "path", or "header".
  - **type** `string` - **REQUIRED**. The date parameter type. Value MUST be either "fromDate" or "toDate".
  - **format** `string` - **REQUIRED**. The date format pattern for the parameter (e.g., "YYYY-MM-DD").